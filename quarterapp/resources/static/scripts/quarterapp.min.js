(function(e){function O(e,t){return function(n){return j(e.call(this,n),t)}}function M(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function _(){}function D(e){H(this,e)}function P(e){var t=this._data={},n=e.years||e.year||e.y||0,r=e.months||e.month||e.M||0,i=e.weeks||e.week||e.w||0,s=e.days||e.day||e.d||0,o=e.hours||e.hour||e.h||0,u=e.minutes||e.minute||e.m||0,a=e.seconds||e.second||e.s||0,f=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=f+1e3*a+6e4*u+36e5*o,this._days=s+7*i,this._months=r+12*n,t.milliseconds=f%1e3,a+=B(f/1e3),t.seconds=a%60,u+=B(a/60),t.minutes=u%60,o+=B(u/60),t.hours=o%24,s+=B(o/24),s+=7*i,t.days=s%30,r+=B(s/30),t.months=r%12,n+=B(r/12),t.years=n}function H(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function B(e){return 0>e?Math.ceil(e):Math.floor(e)}function j(e,t){for(var n=e+"";t>n.length;)n="0"+n;return n}function F(e,t,n){var o,r=t._milliseconds,i=t._days,s=t._months;r&&e._d.setTime(+e+r*n),i&&e.date(e.date()+i*n),s&&(o=e.date(),e.date(1).month(e.month()+s*n).date(Math.min(o,e.daysInMonth())))}function I(e){return"[object Array]"===Object.prototype.toString.call(e)}function q(e,t){var s,n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0;for(s=0;n>s;s++)~~e[s]!==~~t[s]&&i++;return i+r}function R(e,t){return t.abbr=e,s[e]||(s[e]=new _),s[e].set(t),s[e]}function U(e){return e?(!s[e]&&o&&require("./lang/"+e),s[e]):t.fn._lang}function z(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var n,r,t=e.match(a);for(n=0,r=t.length;r>n;n++)t[n]=A[t[n]]?A[t[n]]:z(t[n]);return function(i){var s="";for(n=0;r>n;n++)s+="function"==typeof t[n].call?t[n].call(i,e):t[n];return s}}function X(e,t){function r(t){return e.lang().longDateFormat(t)||t}for(var n=5;n--&&f.test(t);)t=t.replace(f,r);return C[t]||(C[t]=W(t)),C[t](e)}function V(e){switch(e){case"DDDD":return p;case"YYYY":return d;case"YYYYY":return v;case"S":case"SS":case"SSS":case"DDD":return h;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return m;case"X":return b;case"Z":case"ZZ":return g;case"T":return y;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return c;default:return RegExp(e.replace("\\",""))}}function $(e,t,n){var r,s=n._a;switch(e){case"M":case"MM":s[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":r=U(n._l).monthsParse(t),null!=r?s[1]=r:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(s[2]=~~t);break;case"YY":s[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":s[0]=~~t;break;case"a":case"A":n._isPm="pm"===(t+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":s[3]=~~t;break;case"m":case"mm":s[4]=~~t;break;case"s":case"ss":s[5]=~~t;break;case"S":case"SS":case"SSS":s[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,r=(t+"").match(x),r&&r[1]&&(n._tzh=~~r[1]),r&&r[2]&&(n._tzm=~~r[2]),r&&"+"===r[0]&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}null==t&&(n._isValid=!1)}function J(e){var t,n,r=[];if(!e._d){for(t=0;7>t;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];r[3]+=e._tzh||0,r[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(r[0],r[1],r[2]),n.setUTCHours(r[3],r[4],r[5],r[6])):(n.setFullYear(r[0],r[1],r[2]),n.setHours(r[3],r[4],r[5],r[6])),e._d=n}}function K(e){var r,i,t=e._f.match(a),n=e._i;for(e._a=[],r=0;t.length>r;r++)i=(V(t[r]).exec(n)||[])[0],i&&(n=n.slice(n.indexOf(i)+i.length)),A[t[r]]&&$(t[r],i,e);e._isPm&&12>e._a[3]&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),J(e)}function Q(e){for(var t,n,r,u,i=99;e._f.length;){if(t=H({},e),t._f=e._f.pop(),K(t),n=new D(t),n.isValid()){r=n;break}u=q(t._a,n.toArray()),i>u&&(i=u,r=n)}H(e,r)}function G(e){var t,n=e._i;if(w.exec(n)){for(e._f="YYYY-MM-DDT",t=0;4>t;t++)if(S[t][1].exec(n)){e._f+=S[t][0];break}g.exec(n)&&(e._f+=" Z"),K(e)}else e._d=new Date(n)}function Y(t){var n=t._i,r=u.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):"string"==typeof n?G(t):I(n)?(t._a=n.slice(0),J(t)):t._d=n instanceof Date?new Date(+n):new Date(n)}function Z(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function et(e,t,n){var i=r(Math.abs(e)/1e3),s=r(i/60),o=r(s/60),u=r(o/24),a=r(u/365),f=45>i&&["s",i]||1===s&&["m"]||45>s&&["mm",s]||1===o&&["h"]||22>o&&["hh",o]||1===u&&["d"]||25>=u&&["dd",u]||45>=u&&["M"]||345>u&&["MM",r(u/30)]||1===a&&["y"]||["yy",a];return f[2]=t,f[3]=e>0,f[4]=n,Z.apply({},f)}function tt(e,n,r){var i=r-n,s=r-e.day();return s>i&&(s-=7),i-7>s&&(s+=7),Math.ceil(t(e).add("d",s).dayOfYear()/7)}function nt(e){var n=e._i,r=e._f;return null===n||""===n?null:("string"==typeof n&&(e._i=n=U().preparse(n)),t.isMoment(n)?(e=H({},n),e._d=new Date(+n._d)):r?I(r)?Q(e):K(e):Y(e),new D(e))}function rt(e,n){t.fn[e]=t.fn[e+"s"]=function(e){var t=this._isUTC?"UTC":"";return null!=e?(this._d["set"+t+n](e),this):this._d["get"+t+n]()}}function it(e){t.duration.fn[e]=function(){return this._data[e]}}function st(e,n){t.duration.fn["as"+e]=function(){return+this/n}}for(var t,i,n="2.0.0",r=Math.round,s={},o="undefined"!=typeof module&&module.exports,u=/^\/?Date\((\-?\d+)/i,a=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,f=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,c=/\d\d?/,h=/\d{1,3}/,p=/\d{3}/,d=/\d{1,4}/,v=/[+\-]?\d{1,6}/,m=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,g=/Z|[\+\-]\d\d:?\d\d/i,y=/T/i,b=/[\+\-]?\d+(\.\d{1,3})?/,w=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,E="YYYY-MM-DDTHH:mm:ssZ",S=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],x=/([\+\-]|\d\d)/gi,T="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),N={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},C={},k="DDD w W M D d".split(" "),L="M D H h m s w W".split(" "),A={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return j(this.year()%100,2)},YYYY:function(){return j(this.year(),4)},YYYYY:function(){return j(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return j(~~(this.milliseconds()/10),2)},SSS:function(){return j(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+j(~~(e/60),2)+":"+j(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+j(~~(10*e/6),4)},X:function(){return this.unix()}};k.length;)i=k.pop(),A[i+"o"]=M(A[i]);for(;L.length;)i=L.pop(),A[i+i]=O(A[i],2);for(A.DDDD=O(A.DDD,3),_.prototype={set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var n,r,i;for(this._monthsParse||(this._monthsParse=[]),n=0;12>n;n++)if(this._monthsParse[n]||(r=t([2e3,n]),i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=RegExp(i.replace(".",""),"i")),this._monthsParse[n].test(e))return n},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return"function"==typeof i?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return tt(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},t=function(e,t,n){return nt({_i:e,_f:t,_l:n,_isUTC:!1})},t.utc=function(e,t,n){return nt({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},t.unix=function(e){return t(1e3*e)},t.duration=function(e,n){var o,r=t.isDuration(e),i="number"==typeof e,s=r?e._data:i?{}:e;return i&&(n?s[n]=e:s.milliseconds=e),o=new P(s),r&&e.hasOwnProperty("_lang")&&(o._lang=e._lang),o},t.version=n,t.defaultFormat=E,t.lang=function(e,n){return e?(n?R(e,n):s[e]||U(e),t.duration.fn._lang=t.fn._lang=U(e),void 0):t.fn._lang._abbr},t.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),U(e)},t.isMoment=function(e){return e instanceof D},t.isDuration=function(e){return e instanceof P},t.fn=D.prototype={clone:function(){return t(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return t.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!q(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){var n=X(this,e||t.defaultFormat);return this.lang().postformat(n)},add:function(e,n){var r;return r="string"==typeof e?t.duration(+n,e):t.duration(e,n),F(this,r,1),this},subtract:function(e,n){var r;return r="string"==typeof e?t.duration(+n,e):t.duration(e,n),F(this,r,-1),this},diff:function(e,n,r){var o,u,i=this._isUTC?t(e).utc():t(e).local(),s=6e4*(this.zone()-i.zone());return n&&(n=n.replace(/s$/,"")),"year"===n||"month"===n?(o=432e5*(this.daysInMonth()+i.daysInMonth()),u=12*(this.year()-i.year())+(this.month()-i.month()),u+=(this-t(this).startOf("month")-(i-t(i).startOf("month")))/o,"year"===n&&(u/=12)):(o=this-i-s,u="second"===n?o/1e3:"minute"===n?o/6e4:"hour"===n?o/36e5:"day"===n?o/864e5:"week"===n?o/6048e5:o),r?u:B(u)},from:function(e,n){return t.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!n)},fromNow:function(e){return this.from(t(),e)},calendar:function(){var e=this.diff(t().startOf("day"),"days",!0),n=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){var e=this.year();return 0===e%4&&0!==e%100||0===e%400},isDST:function(){return this.zone()<t([this.year()]).zone()||this.zone()<t([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==e?t:this.add({d:e-t})},startOf:function(e){switch(e=e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,n){return n=n!==void 0?n:"millisecond",+this.clone().startOf(n)>+t(e).startOf(n)},isBefore:function(e,n){return n=n!==void 0?n:"millisecond",+this.clone().startOf(n)<+t(e).startOf(n)},isSame:function(e,n){return n=n!==void 0?n:"millisecond",+this.clone().startOf(n)===+t(e).startOf(n)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return t.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var n=r((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return null==e?n:this.add("d",e-n)},isoWeek:function(e){var t=tt(this,1,4);return null==e?t:this.add("d",7*(e-t))},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},lang:function(t){return t===e?this._lang:(this._lang=U(t),this)}},i=0;T.length>i;i++)rt(T[i].toLowerCase().replace(/s$/,""),T[i]);rt("year","FullYear"),t.fn.days=t.fn.day,t.fn.weeks=t.fn.week,t.fn.isoWeeks=t.fn.isoWeek,t.duration.fn=P.prototype={weeks:function(){return B(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(e){var t=+this,n=et(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:t.fn.lang};for(i in N)N.hasOwnProperty(i)&&(st(i,N[i]),it(i.toLowerCase()));st("Weeks",6048e5),t.lang("en",{ordinal:function(e){var t=e%10,n=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),o&&(module.exports=t),"undefined"==typeof ender&&(this.moment=t),"function"==typeof define&&define.amd&&define("moment",[],function(){return t})}).call(this),function(e,t,n){"use strict";var r="function"==typeof e.moment,i=!!e.addEventListener,s=e.setTimeout,o=function(e,t,n,r){i?e.addEventListener(t,n,!!r):e.attachEvent("on"+t,n)},u=function(e,t,n,r){i?e.removeEventListener(t,n,!!r):e.detachEvent("on"+t,n)},a=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},f=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},l=function(e,t){f(e,t)||(e.className=""===e.className?t:e.className+" "+t)},c=function(e,t){e.className=a((" "+e.className+" ").replace(" "+t+" "," "))},h=function(e){return/Array/.test(Object.prototype.toString.call(e))},p=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},d=function(e){return 0===e%4&&0!==e%100||0===e%400},v=function(e,t){return[31,d(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},m=function(e,t){return e.getTime()===t.getTime()},g=function(e,t,r){var i,s;for(i in t)s=e[i]!==n,s&&"object"==typeof t[i]&&t[i].nodeName===n?p(t[i])?r&&(e[i]=new Date(t[i].getTime())):h(t[i])?r&&(e[i]=t[i].slice(0)):e[i]=g({},t[i],r):(r||!s)&&(e[i]=t[i]);return e},y={field:null,bound:n,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,minYear:0,maxYear:9999,minMonth:n,maxMonth:n,isRTL:!1,numberOfMonths:1,i18n:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},onSelect:null,onOpen:null,onClose:null},b=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},w=function(e,t,n,r,i){if(i)return'<td class="is-empty"></td>';var s=[];return r&&s.push("is-disabled"),n&&s.push("is-today"),t&&s.push("is-selected"),'<td data-day="'+e+'" class="'+s.join(" ")+'"><button class="pika-button" type="button">'+e+"</button>"+"</td>"},E=function(e,t){return"<tr>"+(t?e.reverse():e).join("")+"</tr>"},S=function(e){return"<tbody>"+e.join("")+"</tbody>"},x=function(e){var t,n=[];for(t=0;7>t;t++)n.push('<th scope="col"><abbr title="'+b(e,t)+'">'+b(e,t,!0)+"</abbr></th>");return"<thead>"+(e.isRTL?n.reverse():n).join("")+"</thead>"},T=function(e){var t,n,r,i=e._o,s=e._m,o=e._y,u=o===i.minYear,a=o===i.maxYear,f='<div class="pika-title">',l=!0,c=!0;for(r=[],t=0;12>t;t++)r.push('<option value="'+t+'"'+(t===s?" selected":"")+(u&&i.minMonth>t||a&&t>i.maxMonth?"disabled":"")+">"+i.i18n.months[t]+"</option>");for(f+='<div class="pika-label">'+i.i18n.months[s]+'<select class="pika-select pika-select-month">'+r.join("")+"</select></div>",h(i.yearRange)?(t=i.yearRange[0],n=i.yearRange[1]+1):(t=o-i.yearRange,n=1+o+i.yearRange),r=[];n>t&&i.maxYear>=t;t++)t>=i.minYear&&r.push('<option value="'+t+'"'+(t===o?" selected":"")+">"+t+"</option>");return f+='<div class="pika-label">'+o+'<select class="pika-select pika-select-year">'+r.join("")+"</select></div>",u&&(0===s||i.minMonth>=s)&&(l=!1),a&&(11===s||s>=i.maxMonth)&&(c=!1),f+='<button class="pika-prev'+(l?"":" is-disabled")+'" type="button">Previous Month</button>',f+='<button class="pika-next'+(c?"":" is-disabled")+'" type="button">Next Month</button>',f+="</div>"},N=function(e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+x(e)+S(t)+"</table>"};e.Pikaday=function(n){var u=this,a=u.config(n);u._onMouseDown=function(t){if(u._v){t=t||e.event;var n=t.target||t.srcElement;if(n){if(!f(n,"is-disabled")){if(f(n,"pika-button")&&!f(n,"is-empty"))return u.setDate(new Date(u._y,u._m,parseInt(n.innerHTML,10))),a.bound&&s(function(){u.hide()},100),void 0;f(n,"pika-prev")?u.prevMonth():f(n,"pika-next")&&u.nextMonth()}if(f(n,"pika-select"))u._c=!0;else{if(!t.preventDefault)return t.returnValue=!1;t.preventDefault()}}}},u._onChange=function(t){t=t||e.event;var n=t.target||t.srcElement;n&&(f(n,"pika-select-month")?u.gotoMonth(n.value):f(n,"pika-select-year")&&u.gotoYear(n.value))},u._onInputChange=function(){if(r)u.setDate(e.moment(a.field.value,a.format).toDate());else{var n=new Date(Date.parse(a.field.value));u.setDate(p(n)?n:null)}u._v||u.show()},u._onInputFocus=function(){u.show()},u._onInputClick=function(){u.show()},u._onInputBlur=function(){u._c||(u._b=s(function(){u.hide()},50)),u._c=!1},u._onClick=function(t){t=t||e.event;var n=t.target||t.srcElement,r=n;if(n){!i&&f(n,"pika-select")&&(n.onchange||(n.setAttribute("onchange","return;"),o(n,"change",u._onChange)));do if(f(r,"pika-single"))return;while(r=r.parentNode);u._v&&n!==a.field&&u.hide()}},u.el=t.createElement("div"),u.el.className="pika-single"+(a.isRTL?" is-rtl":""),o(u.el,"mousedown",u._onMouseDown,!0),o(u.el,"change",u._onChange),a.field&&(a.bound?t.body.appendChild(u.el):a.field.parentNode.insertBefore(u.el,a.field.nextSibling),o(a.field,"change",u._onInputChange),a.defaultDate||(a.defaultDate=r&&a.field.value?e.moment(a.field.value,a.format).toDate():new Date(Date.parse(a.field.value)),a.setDefaultDate=!0));var l=a.defaultDate;p(l)?a.setDefaultDate?u.setDate(l):u.gotoDate(l):u.gotoDate(new Date),a.bound?(this.hide(),u.el.className+=" is-bound",o(a.field,"click",u._onInputClick),o(a.field,"focus",u._onInputFocus),o(a.field,"blur",u._onInputBlur)):this.show()},e.Pikaday.prototype={config:function(e){this._o||(this._o=g({},y,!0));var t=g(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.bound=!!(t.bound!==n?t.field&&t.bound:t.field);var r=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=r>4?4:r,p(t.minDate)||(t.minDate=!1),p(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&(t.minYear=t.minDate.getFullYear(),t.minMonth=t.minDate.getMonth()),t.maxDate&&(t.maxYear=t.maxDate.getFullYear(),t.maxMonth=t.maxDate.getMonth()),h(t.yearRange)){var i=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||i,t.yearRange[1]=parseInt(t.yearRange[1],10)||i}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||y.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(t){return p(this._d)?r?e.moment(this._d).format(t||this._o.format):this._d.toDateString():""},getMoment:function(){return r?e.moment(this._d):null},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(e){if(!e)return this._d=null,this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),p(e)){var t=this._o.minDate,n=this._o.maxDate;p(t)&&t>e?e=t:p(n)&&e>n&&(e=n),this._d=new Date(e.getTime()),this._d.setHours(0,0,0,0),this.gotoDate(this._d),this._o.field&&(this._o.field.value=""+this),"function"==typeof this._o.onSelect&&this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){p(e)&&(this._y=e.getFullYear(),this._m=e.getMonth(),this.draw())},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e=parseInt(e,10))||(this._m=0>e?0:e>11?11:e,this.draw())},nextMonth:function(){++this._m>11&&(this._m=0,this._y++),this.draw()},prevMonth:function(){0>--this._m&&(this._m=11,this._y--),this.draw()},gotoYear:function(e){isNaN(e)||(this._y=parseInt(e,10),this.draw())},draw:function(e){if(this._v||e){var t=this._o,n=t.minYear,r=t.maxYear,i=t.minMonth,o=t.maxMonth;if(n>=this._y&&(this._y=n,!isNaN(i)&&i>this._m&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o)),this.el.innerHTML=T(this)+this.render(this._y,this._m),t.bound){for(var u=t.field,a=u.offsetLeft,f=u.offsetTop+u.offsetHeight;u=u.offsetParent;)a+=u.offsetLeft,f+=u.offsetTop;this.el.style.cssText="position:absolute;left:"+a+"px;top:"+f+"px;",s(function(){t.field.focus()},1)}}},render:function(e,t){var n=this._o,r=new Date,i=v(e,t),s=new Date(e,t,1).getDay(),o=[],u=[];r.setHours(0,0,0,0),n.firstDay>0&&(s-=n.firstDay,0>s&&(s+=7));for(var a=i+s,f=a;f>7;)f-=7;a+=7-f;for(var l=0,c=0;a>l;l++){var h=new Date(e,t,1+(l-s)),d=n.minDate&&n.minDate>h||n.maxDate&&h>n.maxDate,g=p(this._d)?m(h,this._d):!1,y=m(h,r),b=s>l||l>=i+s;u.push(w(1+(l-s),g,y,d,b)),7===++c&&(o.push(E(u,n.isRTL)),u=[],c=0)}return N(n,o)},isVisible:function(){return this._v},show:function(){this._v||(this._o.bound&&o(t,"click",this._onClick),c(this.el,"is-hidden"),this._v=!0,this.draw(),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;e!==!1&&(this._o.bound&&u(t,"click",this._onClick),this.el.style.cssText="",l(this.el,"is-hidden"),this._v=!1,e!==n&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),u(this.el,"mousedown",this._onMouseDown,!0),u(this.el,"change",this._onChange),this._o.field&&(u(this._o.field,"change",this._onInputChange),this._o.bound&&(u(this._o.field,"click",this._onInputClick),u(this._o.field,"focus",this._onInputFocus),u(this._o.field,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}}(window,window.document),function(){"use strict";function Quarterapp(){}Quarterapp.prototype={constructor:Quarterapp,luminance:function(hex,lum){try{hex=(hex+"").replace(/[^0-9a-f]/gi,""),6>hex.length&&(hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]),lum=lum||0;var c,i,rgb="#";for(i=0;3>i;i++)c=parseInt(hex.substr(2*i,2),16),c=Math.round(Math.min(Math.max(0,c+c*lum),255)).toString(16),rgb+=("00"+c).substr(c.length);return rgb}catch(e){return hex}},to_date_string:function(date){var month=""+(date.getMonth()+1);1===month.length&&(month="0"+month);var day=""+date.getDate();return 1===day.length&&(day="0"+day),"{0}-{1}-{2}".format(date.getFullYear(),month,day)},log:function(msg){void 0!==console.log&&console.log(msg)}},window.quarterapp=new Quarterapp}(),void 0===String.prototype.format&&(String.prototype.format=function(){for(var formatted=this,i=0;arguments.length>i;i++){var regexp=RegExp("\\{"+i+"\\}","gi");formatted=formatted.replace(regexp,arguments[i])}return formatted}),$.cssHooks.backgroundColor={get:function(elem){function hex(x){return("0"+parseInt(x).toString(16)).slice(-2)}if(elem.currentStyle)var bg=elem.currentStyle.backgroundColor;else if(window.getComputedStyle)var bg=document.defaultView.getComputedStyle(elem,null).getPropertyValue("background-color");return-1==bg.search("rgb")?bg:(bg=bg.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+hex(bg[1])+hex(bg[2])+hex(bg[3]))}},function($){"use strict";function Validator(form,options,strategies){this.options=$.extend({},$.fn.validator.defaults,options),this.strategies=$.extend({},$.fn.validator.strategies,strategies),this.$form=$(form),this.$elements=jQuery(),this.init()}Validator.prototype={init:function(){var self=this;this.$elements=this.$form.find("input[data-validator]"),this.$form.find('input[data-validator-on="focus-loss"]').each(function(i,e){$(e).blur($.proxy(self.on_blur,self))}),this.$form.submit($.proxy(this.on_submit,this))},on_blur:function(event){this.validate_element($(event.target))},on_submit:function(event){var self=this;return $.each(this.$elements,function(index,element){self.validate_element($(element))}),this.$form.find("input."+self.options.error_class).length>0?(this.$form.attr("data-validation-result","not-valid"),event.preventDefault(),!1):!0},validate_element:function($element){var self=this,strategies=$element.attr("data-validator").split(" ");$.each(strategies,function(index,element_strategy){var strategy=self.strategies[element_strategy];if(void 0!==strategy){var message=strategy.check(self,$element);if(void 0!==message)return $element.hasClass(self.options.error_class)||$element.addClass(self.options.error_class),0==$element.siblings("div.input-error").length&&$element.after('<div class="input-error">'+message+"</div>"),!1;$element.removeClass(self.options.error_class),$element.siblings("div.input-error").remove()}})}},$.fn.validator=function(options,strategies){return this.each(function(){var $this=$(this),data=$this.data("validator"),opts=$.extend({},options),stgs=$.extend({},strategies);data||$this.data("validator",data=new Validator($this,opts,stgs))})},$.fn.validator.defaults={error_class:"error"},$.fn.validator.strategies={required:{check:function(self,$element){var type=$element.attr("type"),valid=!1;return"checkbox"===type?valid=$element.attr("checked"):("text"===type||"password"===type)&&(valid=$element.val().length>0),valid?void 0:"This field is required"}},email:{check:function(self,$element){var type=$element.attr("type"),valid=!1;return"text"===type&&(valid=/\S+@\S+\.\S+/.test($element.val())),valid?void 0:"This is not a valid email adress"}},password:{check:function(self,$element){var type=$element.attr("type"),valid=!1;if("password"===type){var text=$element.val();if(valid=text.length>7,!valid)return"Password needs to be more than 7 characters"}return void 0}},mirror:{check:function(self,$element){var mirror=$element.attr("data-validator-mirror");if(void 0!==mirror){var $mirror=self.$form.find("#"+mirror);if($element.val()!==$mirror.val())return"Not matching"}return void 0}},"color-hex":{check:function(self,$element){var type=$element.attr("type"),valid=!1;if("text"===type){var text=$element.val();if(valid=/^(#)?([0-9a-fA-F]{3})([0-9a-fA-F]{3})?$/.test(text),!valid)return"Must be a hex color code (e.g. #ffbbcc)"}return void 0}}},$.fn.validator.Constructor=Validator,$(function(){$("form[data-validation]").validator()})}(jQuery),function($){"use strict";var Palette=function(element,options){this.$element=$(element),this.options=$.extend({},$.fn.palette.defaults,options),this.$label=$(element).siblings("label"),this.palette_code='<div class="color-palette"></div>',this.visible=!1,this.init()};Palette.prototype={constructor:Palette,init:function(){this.$element.on("click",$.proxy(this.show,this))},show:function(event){var self=this;if(1!=this.$element.data("disabled")&&(event.stopPropagation(),!this.visible)){this.$element.after(this.palette_code);var palette=this.$element.siblings(".color-palette"),position=this.$element.position(),top=0,left=position.left+this.$element.width()+10;palette.click(function(event){event.stopPropagation()});for(var i=0;this.options.palette.length>i;i++)palette.append('<div class="palette-color" style="background-color:#'+this.options.palette[i]+'"></div>');palette.css({top:top,left:left}).fadeIn("fast"),this.visible=!0,$("html").click(function(){$(palette).fadeOut("fast",function(){$(palette).remove(),self.visible=!1})}),$(".palette-color").on("click",function(){var color=$(this).css("background-color");self.$element.css("color",color),self.$element.css("background-color",color),self.$element.attr("data-colorpicker-value",color),self.$element.val(color),$(palette).fadeOut("fast",function(){$(palette).remove(),self.visible=!1})})}}},$.fn.palette=function(options){return this.each(function(){var $this=$(this),data=$this.data("palette");data||$this.data("palette",data=new Palette(this,options))})},$.fn.palette.defaults={showCode:!1,palette:["fce94f","edd400","c4a000","fcaf3e","f57900","ce5c00","e9b96e","c17d11","8f5902","8ae234","73d216","4e9a06","729fcf","3465a4","204a87","ad7fa8","75507b","5c3566","ef2929","cc0000","a40000","888a85","555753","2e3436"]},$.fn.palette.Constructor=Palette,$(function(){$("input.palette").palette()}())}(jQuery),function($){"use strict";var Switcher=function(element,options){this.$element=$(element),this.options=$.extend({},$.fn.palette.defaults,options),this.init()};Switcher.prototype={constructor:Switcher,init:function(){this.$element.on("click",$.proxy(this.on_switch,this))},on_switch:function(){this.$element.hasClass("on")?this.$element.removeClass("on").addClass("off"):this.$element.removeClass("off").addClass("on")}},$.fn.switcher=function(options){return this.each(function(){var $this=$(this),data=$this.data("switcher");data||$this.data("switcher",data=new Switcher(this,options))})},$.fn.switcher.defaults={},$.fn.switcher.Constructor=Switcher,$(function(){$(".switcher").switcher()}())}(jQuery),function($){"use strict";function Category(invoker,options){this.options=$.extend({},$.fn.category.defaults,options),this.$invoker=$(invoker),this.$overlay=$("#modal-overlay"),this.$modal=$("#category-modal"),this.category_action=this.$invoker.attr("data-category-action"),this.category_group_markup='<section class="group activities" data-category-id="{0}"><section class="header"><h3><span class="icon medium category">&nbsp;</span><span class="category-title">{1}</span></h3></section><section class="content"></section><section class="actions"><a class="button positive" href="#" data-activity-action="new" data-category-id="{0}">New activity</a><a class="button" href="#" data-new-category-action data-category-action="edit" data-category-id="{0}">Edit category</a><a class="button negative delete" href="#" data-category-action="delete" data-category-id="{0}">Delete</a></section></section>',this.init()}Category.prototype={constructor:Category,init:function(){this.$invoker.on("click",$.proxy(this.on_action,this))},on_action:function(event){var self=this;if(event.preventDefault(),"delete"===this.category_action){var category_id=this.$invoker.attr("data-category-id");return this.delete_category(category_id),!1}if("edit"===this.category_action){$("#category-modal").find("h2").html("Edit category");var category_id=this.$invoker.attr("data-category-id");this.update_field_values(category_id)}return this.$modal.addClass("show"),this.$overlay.addClass("show"),this.$overlay.on("click",$.proxy(this.on_close,this)),this.$modal.find(".button.close").on("click",$.proxy(this.on_close,this)),self.$modal.find("form").on("submit",$.proxy(this.on_submit,this)),!1},on_close:function(){return this.$modal.removeClass("show"),this.$overlay.removeClass("show"),this.$modal.find("form").off("submit"),this.$overlay.off("click"),this.$modal.find(".button.close").on("off"),this.restore_modal(),!1
},on_submit:function(event){var title=this.$modal.find("input").val();if(event.preventDefault(),"edit"===this.category_action){var category_id=this.$invoker.attr("data-category-id");this.update_category(category_id,title)}else this.create_category(title);return!1},restore_modal:function(){var $title=this.$modal.find("input");$title.val(""),$title.removeClass("error"),$title.siblings("div.input-error").remove()},update_field_values:function(category_id){var self=this;void 0!=category_id&&$.ajax({url:"/api/category/"+category_id,success:function(data){$("#category-title").val(data.title),self.$modal.find("form").on("submit",$.proxy(this.on_submit,this))},error:function(){$("#category-title").attr("disabled","disabled"),self.$modal.find(".message").addClass("negative").html("Could not retrieve category details!"),self.$modal.find("form").attr("disabled","disabled")}})},create_category:function(title){var self=this;$.ajax({url:"/api/category",type:"POST",data:{title:title},success:function(data){self.add_category_group(data),$("body").trigger("ajax"),self.on_close()},error:function(){self.$modal.find(".message").addClass("negative").html("<span class='icon error'>&nbsp;</span>Could not create category!")}})},update_category:function(category_id,title){var self=this;$.ajax({url:"/api/category/"+category_id,type:"PUT",data:{title:title},success:function(data){self.$invoker.parents(".group.activities").find(".category-title").html(data.title),$("body").trigger("ajax"),self.on_close()},error:function(){self.$modal.find(".message").addClass("negative").html("<span class='icon error'>&nbsp;</span>Could not update category!")}})},delete_category:function(category_id){var self=this;$.ajax({url:"/api/category/"+category_id,type:"DELETE",success:function(){self.$invoker.parents(".group.activities").remove()},error:function(){quarterapp.log("Could not delete category")}})},add_category_group:function(category){var $list=$(".container.main");$list.append(this.category_group_markup.format(category.id,category.title))}},$.fn.category=function(options){var useOptions={};return void 0!==options&&(useOptions=options),this.each(function(){var $this=$(this),data=$this.data("category");data||($this.data("category",data=new Category($this,useOptions)),useOptions={})})},$.fn.category.defaults={},$.fn.category.Constructor=Category,$("body").on("ajax",function(){$("[data-category-action]").category()}),$(function(){$("[data-category-action]").category()}())}(jQuery),function($){"use strict";function Activity(invoker,options){this.options=$.extend({},$.fn.activity.defaults,options),this.$invoker=$(invoker),this.$overlay=$("#modal-overlay"),this.$modal=$("#activity-modal"),this.activity_action=this.$invoker.attr("data-activity-action"),this.activity_bar_markup='<div class="activity-bar"><div class="activity-palette" style="background-color: {3};"></div><div class="activity-details"><div class="activity-title">{2}</div><div class="quarter-count">Using <span class="count">0</span> quarters</div></div><a href="#" class="icon medium edit" data-activity-action="edit" data-activity-id="{1}" data-category-id="{0}">&nbsp;</a></div>',this.activity_disabled_bar_markup='<div class="activity-bar disabled"><div class="activity-palette" style="background-color: {3};"></div><div class="activity-details"><div class="activity-title">{2}</div><div class="quarter-count">Using <span class="count">0</span> quarters</div></div><a href="#" class="icon medium edit" data-activity-action="edit" data-activity-id="{1}" data-category-id="{0}">&nbsp;</a><span class="disabled"></span></div>',this.init()}Activity.prototype={constructor:Activity,init:function(){this.$invoker.on("click",$.proxy(this.on_action,this))},on_action:function(){var self=this;if("edit"===this.activity_action){$("#activity-modal").find("h2").html("Edit activity");var activity_id=this.$invoker.attr("data-activity-id");this.update_field_values(activity_id),this.$modal.find(".button.delete").show(),this.$modal.find(".button.delete").on("click",$.proxy(this.on_delete,this))}else this.$modal.find(".button.delete").hide();return this.$modal.addClass("show"),this.$overlay.addClass("show"),this.$overlay.on("click",$.proxy(this.on_close,this)),this.$modal.find(".button.close").on("click",$.proxy(this.on_close,this)),self.$modal.find("form").on("submit",$.proxy(this.on_submit,this)),!1},on_close:function(){return event.preventDefault(),this.$modal.removeClass("show"),this.$overlay.removeClass("show"),this.$modal.find("form").off("submit"),this.$overlay.off("click"),this.$modal.find(".button.close").off("click"),this.$modal.find(".button.delete").off("click"),this.restore_modal(),!1},on_submit:function(event){var category_id=this.$invoker.attr("data-category-id"),title=this.$modal.find("input.title").val(),color=this.$modal.find("input.color").val(),enabled=this.$modal.find(".input.switcher").hasClass("on");if(event.preventDefault(),"edit"===this.activity_action){var activity_id=this.$invoker.attr("data-activity-id");this.update_activity(activity_id,category_id,title,color,enabled)}else this.create_activity(category_id,title,color,enabled);return!1},on_delete:function(event){var self=this,activity_id=this.$invoker.attr("data-activity-id");return event.preventDefault(),$.ajax({url:"/api/activity/"+activity_id,type:"DELETE",success:function(){self.$invoker.parents(".activity-bar").remove(),self.on_close()},error:function(){self.$modal.find(".message").addClass("negative").html("<span class='icon error'>&nbsp;</span>Could not delete activity!")}}),!1},restore_modal:function(){var $title=this.$modal.find("input.title"),$color=this.$modal.find("input.color");$title.val(""),$title.removeClass("error"),$title.siblings("div.input-error").remove(),$color.val("#fff"),$color.css("background-color","#fff"),$color.css("color","#fff"),$color.removeClass("error"),$color.siblings("div.input-error").remove(),this.$modal.find(".message").html(""),this.$modal.find(".input.switcher").removeClass("off").addClass("on")},update_field_values:function(activity_id){var self=this;void 0!=activity_id&&$.ajax({url:"/api/activity/"+activity_id,success:function(data){self.$modal.find("input.title").val(data.title),self.$modal.find("input.color").val(data.color),self.$modal.find("input.color").css("background-color",data.color).css("color",data.color),data.enabled?self.$modal.find(".input.switcher").removeClass("off").addClass("on"):self.$modal.find(".input.switcher").removeClass("on").addClass("off"),self.$modal.find("form").on("submit",$.proxy(this.on_submit,this))},error:function(){$("#category-title").attr("disabled","disabled"),self.$modal.find(".message").addClass("negative").html("<span class='icon error'>&nbsp;</span>Could not retrieve activity details!"),self.$modal.find("form").attr("disabled","disabled")}})},create_activity:function(category_id,title,color,enabled){var self=this;$.ajax({url:"/api/activity",type:"POST",data:{category:category_id,title:title,color:color,enabled:enabled},success:function(data){self.add_activity_bar(data),$("body").trigger("ajax"),self.on_close()},error:function(){self.$modal.find(".message").addClass("negative").html("<span class='icon error'>&nbsp;</span>Could not create activity!")}})},update_activity:function(activity_id,category_id,title,color,enabled){var self=this;$.ajax({url:"/api/activity/"+activity_id,type:"PUT",data:{category:category_id,title:title,color:color,enabled:enabled},success:function(data){self.$invoker.siblings(".activity-palette").css("background-color",data.color),self.$invoker.siblings(".activity-details").find(".activity-title").html(data.title),self.$invoker.parents(".activity-bar").removeClass("disabled"),data.enabled||self.$invoker.parents(".activity-bar").addClass("disabled"),$("body").trigger("ajax"),self.on_close()},error:function(){self.$modal.find(".message").addClass("negative").html("<span class='icon error'>&nbsp;</span>Could not update activity!")}})},add_activity_bar:function(activity){var $list=$("section.group[data-category-id='"+activity.category+"']").find(".content");activity.enabled?$list.append(this.activity_bar_markup.format(activity.category,activity.id,activity.title,activity.color)):$list.append(this.activity_disabled_bar_markup.format(activity.category,activity.id,activity.title,activity.color))}},$.fn.activity=function(options){var useOptions={};return void 0!==options&&(useOptions=options),this.each(function(){var $this=$(this),data=$this.data("activity");data||($this.data("activity",data=new Activity($this,useOptions)),useOptions={})})},$.fn.activity.defaults={},$.fn.activity.Constructor=Activity,$("body").on("ajax",function(){$("a[data-activity-action]").activity()}),$(function(){$("a[data-activity-action]").activity()}())}(jQuery),function($){"use strict";function Timesheet(invoker,options){this.options=$.extend({},$.fn.category.defaults,options),this.current_activity={id:-1,color:"#fff",title:"Idle"},this.summary_markup='<tr data-activity-id="{0}" style="color: {1};"><td class="sheettime-value">{2}</td><td class="sheettime-name">{3}</td></tr>',this.pending_update=0,this.current_date=void 0,this.$overlay=$("#modal-overlay"),this.$comment_modal=$("#comment-modal"),this.$comment_invoker=jQuery(),this.init()}Timesheet.prototype={constructor:Timesheet,init:function(){if($(".activity-row").on("click",$.proxy(this.on_select_activity,this)),$("table.sheet tr").slice(0,6).hide(),$("table.sheet tr").slice(18,24).hide(),$("#extend-sod").on("click",$.proxy(this.on_extend_sod,this)),$("#extend-eod").on("click",$.proxy(this.on_extend_eod,this)),$("table.sheet td").bind("mousedown",$.proxy(this.on_sheet_mouse_down,this)),$("table.sheet td").bind("mousemove",$.proxy(this.on_sheet_mouse_move,this)),$("body").bind("mouseup",$.proxy(this.on_sheet_mouse_up,this)),$("table.sheet td span").bind("dblclick",$.proxy(this.on_show_quarter_comment,this)),$("#datepicker").length>0){var current_date=$("#sheet").attr("data-sheet-date");this.current_date=new Date(current_date),new Pikaday({field:document.getElementById("datepicker"),firstDay:1,defaultDate:this.current_date,setDefaultDate:!0,onSelect:$.proxy(this.on_select_date,this)})}var activity=this.get_preferred_activity();this.set_current_activity(activity),this.show_sheets_activities()},on_select_date:function(date){if(date.getFullYear()!==this.current_date.getFullYear()||date.getMonth()!==this.current_date.getMonth()||date.getDate()!==this.current_date.getDate()){var location="/application/timesheet/"+quarterapp.to_date_string(date);window.location=location}},on_extend_sod:function(){for(var $rows=$("table.sheet tbody tr").slice(0,11),i=$rows.length-1;i>-1;i--)if(!$rows.eq(i).is(":visible"))return $rows.eq(i).show(),void 0},on_extend_eod:function(){for(var $rows=$("table.sheet tbody tr").slice(12,24),i=0;$rows.length>i;i++)if(!$rows.eq(i).is(":visible"))return $rows.eq(i).show(),void 0},on_select_activity:function(event){var $element=$(event.target).closest(".activity-row"),new_id=$element.attr("data-activity-id"),new_color=$element.attr("data-activity-color"),new_title=$element.attr("data-activity-title"),activity={id:new_id,color:new_color,title:new_title};this.set_current_activity(activity)},on_sheet_mouse_down:function(event){1===event.which&&(this.pending_update=event.timeStamp)},on_sheet_mouse_move:function(event){1===event.which&&(0==this.pending_update||200>event.timeStamp-this.pending_update||this.paint_cell($(event.target)))},on_sheet_mouse_up:function(event){function cleanup_pending_activities(){var $activities=$("table.sheet span.activity-cell.pending");$activities.removeAttr("data-activity-previous-id"),$activities.removeAttr("data-activity-previous-color"),$activities.removeClass("pending")}if(1===event.which&&0!=this.pending_update){var self=this,$activities=$("table.sheet span.activity-cell.pending");if($activities.length>0){var indexes=[];$.each($activities,function(index,cell){indexes.push($(cell).attr("data-activity-index"))}),indexes+="",$.ajax({url:"/api/sheet/"+quarterapp.to_date_string(self.current_date),type:"PUT",data:{indexes:indexes,activity:self.current_activity.id},success:function(data){var summary_total=$("#summary-hours"),summary_table=$("#sheet-summary");summary_total.html(new Number(data.total).toFixed(2)),summary_table.empty(),summary_table.append("<tbody></tbody>"),$.each(data.summary,function(index,act){var ac=self.summary_markup.format(act.id,act.color,new Number(act.sum).toFixed(2),act.title);summary_table.append(ac)})},error:function(){}})}cleanup_pending_activities(),this.pending_update=0}},on_show_quarter_comment:function(event){var self=this;this.$comment_invoker=$(event.target).hasClass("activity-cell")?$(event.target):$(event.target).parents(".activity-cell");var quarter_id=this.$comment_invoker.attr("data-quarter-id");return void 0!=quarter_id&&-1!=quarter_id?($.ajax({url:"/api/comment/"+quarter_id,success:function(data){void 0!=data&&$("#comment").val(data.comment)},error:function(){$("#comment").attr("disabled","disabled"),self.$comment_modal.find(".message").addClass("negative").html("Could not retrieve comment!"),self.$comment_modal.find("form").attr("disabled","disabled")}}),this.$comment_modal.addClass("show"),this.$overlay.addClass("show"),this.$overlay.on("click",$.proxy(this.on_comment_close,this)),this.$comment_modal.find(".button.close").on("click",$.proxy(this.on_comment_close,this)),this.$comment_modal.find("form").on("submit",$.proxy(this.on_comment_submit,this)),!1):void 0},on_comment_close:function(){event.preventDefault(),this.$comment_modal.removeClass("show"),this.$overlay.removeClass("show"),this.$comment_modal.find("form").off("submit"),this.$overlay.off("click"),this.$comment_modal.find(".button.close").off("click"),this.$comment_invoker=jQuery()},on_comment_submit:function(event){var self=this,quarter_id=this.$comment_invoker.attr("data-quarter-id"),comment=this.$comment_modal.find("textarea").val();return event.preventDefault(),$.ajax({url:"/api/comment/"+quarter_id,type:"PUT",data:{comment:comment},success:function(){self.on_comment_close()},error:function(){self.$comment_modal.find(".message").addClass("negative").html("<span class='icon error'>&nbsp;</span>Could not save comment!")}}),!1},set_current_activity:function(activity){$(".activity-list").find(".current-activity").removeClass("current-activity"),$(".activity-list").find("[data-activity-id='"+activity.id+"']").find(".icon").addClass("current-activity"),this.current_activity=activity,this.set_preferred_activity(activity)},set_preferred_activity:function(activity){"undefined"!=typeof localStorage&&(localStorage.setItem("quarter-activity-id",activity.id),localStorage.setItem("quarter-activity-title",activity.title),localStorage.setItem("quarter-activity-color",activity.color))},get_preferred_activity:function(){return"undefined"!=typeof localStorage?{id:localStorage.getItem("quarter-activity-id"),title:localStorage.getItem("quarter-activity-title"),color:localStorage.getItem("quarter-activity-color")}:this.current_activity},show_sheets_activities:function(){for(var $early_rows=$("table.sheet tbody tr").slice(0,11),$late_rows=$("table.sheet tbody tr").slice(12,24),found_it=!1,process_row=function(){return found_it===!0?($current_row.show(),!0):!$current_row.is(":visible")&&$current_row.find("span[data-activity-id!='-1']").length>0?($current_row.show(),!0):void 0},i=0;$early_rows.length>i;i++){var $current_row=$early_rows.eq(i);found_it=process_row($current_row,found_it)}found_it=!1;for(var i=$late_rows.length-1;i>-1;i--){var $current_row=$late_rows.eq(i);found_it=process_row($current_row,found_it)}},paint_cell:function($activity_cell){var activity_id=$activity_cell.attr("data-activity-id");void 0!==activity_id&&void 0===$activity_cell.attr("data-activity-previous-id")&&($activity_cell.attr("data-activity-previous-id",activity_id),$activity_cell.attr("data-activity-previous-color",$activity_cell.css("background-color")),$activity_cell.attr("data-activity-id",this.current_activity.id),$activity_cell.css("background-color",this.current_activity.color),$activity_cell.css("border-color",quarterapp.luminance(this.current_activity.color,-.2)),$activity_cell.addClass("pending"))}},$.fn.timesheet=function(options){var useOptions={};return void 0!==options&&(useOptions=options),this.each(function(){var $this=$(this),data=$this.data("timesheet");data||($this.data("timesheet",data=new Timesheet($this,useOptions)),useOptions={})})},$.fn.timesheet.defaults={},$.fn.timesheet.Constructor=Timesheet,$(function(){$("body").timesheet()}())}(jQuery),function($){"use strict";function Report(invoker,options){this.options=$.extend({},$.fn.category.defaults,options),this.init()}Report.prototype={constructor:Report,init:function(){$("input.datepicker").each(function(index,element){new Pikaday({field:element,firstDay:1,setDefaultDate:!0,format:"YYYY-MM-DD"})})}},$.fn.report=function(options){var useOptions={};return void 0!==options&&(useOptions=options),this.each(function(){var $this=$(this),data=$this.data("report");data||($this.data("report",data=new Report($this,useOptions)),useOptions={})})},$.fn.report.defaults={},$.fn.report.Constructor=Report,$(function(){$("body").report()}())}(jQuery);